<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>Speed Up Your Selenium Tests with PhantomJS</title>

    <meta name="description" content="Selenium Conference 2012 - GhostDriver: the glue between Selenium and PhantomJS">
    <meta name="author" content="Ivan De Marino">
    <meta name="viewport" content="width=1024, user-scalable=no">

    <!-- Core and extension CSS files -->
    <link rel="stylesheet" href="./core/deck.core.css">
    <link rel="stylesheet" href="./extensions/goto/deck.goto.css">
    <link rel="stylesheet" href="./extensions/menu/deck.menu.css">
    <link rel="stylesheet" href="./extensions/navigation/deck.navigation.css">
    <link rel="stylesheet" href="./extensions/status/deck.status.css">
    <link rel="stylesheet" href="./extensions/hash/deck.hash.css">
    <link rel="stylesheet" href="./extensions/codemirror/deck.codemirror.css">
    <link rel="stylesheet" href="./extensions/codemirror/themes/default.css">

    <!-- Style theme. More available in /themes/style/ or create your own. -->
    <link rel="stylesheet" href="./themes/style/neustar.css">

    <!-- Transition theme. More available in /themes/transition/ or create your own. -->
    <link rel="stylesheet" href="./themes/transition/vertical-slide.css">

    <script src="./modernizr.custom.js"></script>
</head>

<body class="deck-container">
  <div class="github-ribbon-container">
    <a href="http://github.com/detro/ghostdriver">
      <img style="position: absolute; top: 0; right: 0; border: 0;" src="./images/github-topright-ribbon-green.png" alt="Fork me on GitHub"></a>
  </div>

<!-- Begin slides -->

<section class="slide" id="title">
  <h1>Speed Up Your Selenium Tests with PhantomJS
    <br/>
    <span class="by">Ivan De Marino - Senior Software Engineer / Neustar, Inc.</span>
    <br />
    <span class="whenwhere">Selenium Conference - April 2012</span>
  </h1>
</section>


<section class="slide" id="who-am-i">
  <h2>Who is Ivan De Marino?</h2>
    <p>
      <h3>Senior Engineer at Neustar</h3>
      I lead the development for the Webmetrics Agent
    </p>

    <p>
      <h3>(Main) contributor to <a href="http://phantomjs.org">PhantomJS</a></h3>
      I worked on many things, and contributed stuff like the <strong>Filesystem API</strong> and recently the new <strong>REPL mode</strong>
    </p>

    <p>
      <h3>Spend lots of my time</h3>
      <ul>
        <li><code><a href="http://github.com/detro">github.detro</a> = ivan.convert(italian_espresso || starbucks_espresso);</code></li>
        <li><code><a href="http://twitter.com/detronizator">twitter.detronizator</a> = ivan.rant(news || humor || software || {});</code></li>
        <li><code>food.italian = ivan.cook(recipe || random_ingredients);</code></li>
        <li><code>detro.cycle(good_bike).performance < semi_pro_cyclist.performance;</code></li>
      </ul>
    </p>

    <p>
      <h3>Few months that I started using Selenium</h3>
      So, <em>go easy on me</em> ;-)
    </p>
</section>


<section class="slide" id="webmetrics-agent">
  <h2>Webmetrics Agent</h2>
  <h3>My team is responsible for the <em>(Super) Agent</em>:</h3>
  <ul>
    <li>Service that executes Customer Tests, leveraging Selenium and other projects</li>
    <li>Back-end component running on EC2, Rackspace, Voxel, ...</li>
    <li>Tests written in Javascript</li>
    <li>Custom API mixed with Javascript-to-Selenium bridge</li>
    <li>Test Execution Speed is <strong>key</strong>: some customer scripts require <u>minutes</u> to run!</li>
  </ul>
  <h3 class="slide" id="webmetrics-agent-hiring"><strong>We are Hiring!!!</strong></h3>
</section>


<section class="slide" id"phantomjs-intro">
  <h1>
    <img src="images/phantomjs-wordle.png" alt="PhantomJS logo" />
    <br />
    <span class="by"><a href="http://www.wordle.net">via Wordle</a></span>
  </h1>
</section>


<section class="slide" id="phantomjs">
  <h2>PhantomJS: What's all the fuss about?</h2>
  <p>
    <img style="float: right;" src="images/phantomjs-wordle.png" width="600" alt="PhantomJS logo" />
  </p>
  <ul>
    <li>Headless (Qt)WebKit</li>
    <li>JavaScript-driven: <strong>high hackability</strong></li>
    <li>Ideal for Testing</li>
    <li>
      Momentum
      <ul>
        <li>Great Contributors</li>
        <li>Users and Feedbacks</li>
        <li>Regular Releases</li>
      </ul>
    </li>
    <li>
      Integration
      <ul>
        <li>Poltergeist for Capybara, by Jon Leighton (<a href="https://github.com/jonleighton/poltergeist">github/poltergeist</a>)</li>
        <li>CasperJS, by Nicolas Perriault (<a href="http://casperjs.org/">casperjs.org</a>)</li>
        <li>PhantomJS YUI Test, by Liam Clancy (<a href="https://github.com/metafeather/phantomjs-yuitest">github/phantomjs-yuitest</a>)
        <li>Many other (<a href="http://code.google.com/p/phantomjs/wiki/WhoUsesPhantomJS">the full list</a>)
      </ul>
    </li>
  </ul>
</section>


<section class="slide" id="phantomjs-flexible-intro">
  <h1>FlExIbLe</h1>
</section>


<section class="slide" id="phantomjs-flexible">
  <h2>PhantomJS is flexible</h2>
  <p>
    <div>
    <div class="code" mode="javascript" style="display: none;">var page = require('webpage').create(),
    server = require('webserver').create(),
    port = 8080;

// Launch Server
server.listen(port, function (request, response) {
    console.log(JSON.stringify(request, null, 2));
    response.statusCode = 200;
    response.headers = {"Cache": "no-cache", "Content-Type": "text/html"};
    response.write("<html><head><title>Hello World!</title></head>");
    response.close();
});

// Connect to Server
page.open("http://localhost:" + port + "/foo/bar.php?asdf=true", function (status) {
    if (status === 'success') {
        console.log(page.content);
    }
    phantom.exit();
});</div>
    </div>
  </p>
  <p>
    (Almost) every party in HTTP communication is at hand!
  </p>
</section>


<section class="slide" id="phantomjs-fast-intro">
  <h1>
    <img src="./images/phantom-ray.jpg" />
    <br />
    <span class="by">Prototype Boeing Phantom Ray [<a href="http://en.wikipedia.org/wiki/File:Phantom_ray_rollout.jpg">via Wikipedia</a>]</span>
  </h1>
</section>


<section class="slide" id="phantomjs-fast">
  <h2>PhantomJS aims at being fast</h2>
  <ul>
    <li>Written in (good) Qt C++</li>
    <li><code>no_UI === no_Drawing === low_memory_and_CPU_footprint</code></li>
    <li>Very easy to get started (that's speed too!!!)</li>
    <li>Whole test suite in ~2s on my 4yy old iMac</li>
    <li>Maybe V8 in the future (depends on QtWebKit)</li>
  </ul>
</section>


<section class="slide" id="question-value-time">
  <h1>
    How much do you <em>value</em> your time?
    <br />
    <img src="./images/busy-life.jpg" height="300"/>
    <span class="by">Busy Life, Bloor Street [<a href="http://www.torontosnaps.com/Monuments-and-sculptures/busy-life-11508.html">via</a>]</span>
  </h1>

</section>


<section class="slide" id="time-taken">
  <h2>Time is usually interpreted as:</h2>
  <h1>
    <math style="font-size: 1.1em;">
      <mrow>
        <mi>Time</mi>
        <mo>=</mo>
        <mfrac>
          <mrow>
            <mi>Distance</mi>
          </mrow>
          <mrow>
            <mi>Speed</mi>
          </mrow>
        </mfrac>
      </mrow>
    </math>
  </h1>
</section>


<section class="slide" id="need-speed">
  <h1>
    So, what we need is <em>SPEED</em>!
  </h1>
</section>


<section class="slide" id="test-time">
  <h2>How long does it take do a test?</h2>
  <h1>
    <math>
      <mrow style="font-size: 0.7em;">
        <mi>test.coding.time</mi>
        <mo>=</mo>
        <mi>test.coding.update(platform.ease)</mi>
      </mrow>
      <mrow style="font-size: 0.7em;">
        <mi>test.result.time</mi>
        <mo>=</mo>
        <mi>test.exec(platform.speed, project.size)</mi>
      </mrow>
      <mrow>
        <mi>test.time</mi>
        <mo>&#x2248;</mo>
        <msup style="color: red;">
          <mi>0</mi>
          <mn>i</mn>
        </msup>
        <mo>&#x2062;</mo> <!-- &InvisibleTimes; -->
        <mi>test.coding.time</mi>
        <mo>+</mo>
        <mi style="color: red;">n</mi>
        <mo>&#x2062;</mo> <!-- &InvisibleTimes; -->
        <mi>test.result.time</mi>
      </mrow>
    </math>
  </h1>
</section>


<section class="slide" id="google-cheese-test">
  <h2>Classic example: "Google Cheese!" Test</h2>
  <p>
    <div>
    <div class="code" mode="clike" style="display: none;">public class Example  {
    public static void main(String[] args) {
        WebDriver driver = new FirefoxDriver();

        driver.get("http://www.google.com");                        // Load Google

        WebElement element = driver.findElement(By.name("q"));      // Find the input box

        element.sendKeys("Cheese!");                                // Type "Cheese!"

        element.submit();                                           // Submit the form

        System.out.println("Page title is: " + driver.getTitle());  // Print the Page title

        driver.close();
    }
}</div>
    </div>
  </p>
  <p>
    <div class="slide" id="google-cheese-test-timings">
      <div class="sidenote">
        <p>
          <h4>Test Hardware Specs</h4>
          <ul>
            <li>iMac late 2009</li>
            <li>3.06 Ghz Intel Core Duo (2 x 64bit cores)</li>
            <li>8GB of RAM</li>
          </ul>
        </p>
      </div>
      // TODO
      <ul>
        <li><code>FirefoxDriver</code> takes an average of Xs</li>
        <li><code>ChromeDriver</code> takes an average of Xs</li>
        <li><code>HtmlUnitDriver</code> takes an average of Xs</li>
        <li><code>InternetExplorerDriver</code>... I didn't bother checking :P</li>
      </ul>
    </div>
  </p>
</section>


<section class="slide" id="google-cheese-test-demo">
  <h1>
    <em>Demo</em> // TODO
  </h1>
</section>


<section class="slide" id="test-time-reduce">
  <h1>
    We need to<br/> <code>reduce( <code style="color: red;">test.result.time</code> )</code>
  </h1>
</section>


<section class="slide" id="not-good-for-coding-turnaround">
  // TODO
  <h1>
    Xs<br/> is good <em>overnight tests</em>,<br/> but not so good <em>coding turnaround</em>
  </h1>
</section>


<section class="slide" id="introducing-ghostdriver">
  <h1>
    GhostDriver
    <br/>
    <span class="by">
      <a href="https://github.com/detro/ghostdriver">github/ghostdriver</a>
    </span>
  </h1>
</section>


<section class="slide" id="introducing-ghostdriver-picture">
  <h1>
    <img src="./images/ghostdriver-humor.jpg" />
  </h1>
</section>


<section class="slide" id="whats-ghostdriver">
  <h2>What's GhostDriver?</h2>
  <p>
    <ul>
      <li>Implementation of <a href="http://code.google.com/p/selenium/wiki/JsonWireProtocol">WireProtocol</a> on PhantomJS</li>
      <li>100% Javascript</li>
      <li>Stress test for PhantomJS <code>require("webserver")</code> module</li>
      <li>Most starred issue (<a href="http://code.google.com/p/phantomjs/issues/detail?id=49">#49</a>) on the <a href="http://code.google.com/p/phantomjs/issues/list">official PhantomJS tracker</a></li>
      <li><code>RemoteWebDriver</code> Server</li>
    </ul>
  </p>
</section>


<section class="slide" id="ghostdriver-google-cheese-test">
  <h2>GhostDriver vs. "Google Cheese!" Test?</h2>
  <p>
    <div>
    <div class="code" mode="clike" style="display: none;">public class Example  {
    public static void main(String[] args) {
        WebDriver driver = new RemoteWebDriver(new URL("http://localhost:8080"), cap);

        driver.get("http://www.google.com");                        // Load Google

        WebElement element = driver.findElement(By.name("q"));      // Find the input box

        element.sendKeys("Cheese!");                                // Type "Cheese!"

        element.submit();                                           // Submit the form

        System.out.println("Page title is: " + driver.getTitle());  // Print the Page title

        driver.close();
    }
}</div>
    </div>
  </p>
  // TODO
  <p>
    <div class="slide" id="ghostdriver-google-cheese-test-timings">
      <div class="sidenote">
        <p>
          <h4>Test Hardware Specs</h4>
          <ul>
            <li>iMac late 2009</li>
            <li>3.06 Ghz Intel Core Duo (2 x 64bit cores)</li>
            <li>8GB of RAM</li>
          </ul>
        </p>
      </div>
      <ul>
        <li><code>GhostDriver</code> takes an average of 2s (including start/shutdown)</li>
        <li>~1s if PhantomJS kept running</li>
        <li>Faster than switching to the console window!</li>
      </ul>
    </div>
  </p>
</section>


<section class="slide" id="ghostdriver-demo">
  <h1>
    <em>Demo</em> // TODO
  </h1>
</section>


<section class="slide" id="ghostdriver-architecture">
  <h1>
    <img src="./images/ghostdriver-architecture.png" />
  </h1>
</section>


<section class="slide" id="ghostdriver-pros-and-cons">
  <h2>GhostDriver: Pros & Cons</h2>
  <h3>Pros</h3>
  <ul>
    <li>Fast Test Results => Faster Coding Turnaround</li>
    <li>Easy Setup: store it in your Repo
      <ul>
        <li>PhantomJS ~10/15Mb</li>
        <li>GhostDriver ~0.2Mb</li>
      </ul>
    </li>
    <li>Hackable and Tunable (JavaScript / C++)</li>
    <li>Multiple Sessions without a glitch</li>
  </ul>
  <h3>Cons</h3>
  <ul>
    <li>PhantomJS ~= Real Browser</li>
    <li>Only 13 of of 95 Wire Protocol Commands implemented (13.68%)</li>
  </ul>
</section>


<section class="slide" id="ghostdriver-project-status">
  <h2>GhostDriver: Project Status</h2>
  <ul>
    <li>Not ready for production</li>
    <li>Project just started (<strong>only 1 week</strong> of solid coding)</li>
    <li>Help! FORK and HACK with me</li>
    <li>Neustar Webmetrics will offer it</li>
    <li>Imporant items in the TODO list:
      <ul>
        <li>Multiple Frames per Window</li>
        <li>Proxy</li>
        <li>Screenshot</li>
        <li>Capabilities negotiation</li>
        <li>Tailored (Java) Bindings</li>
        <li>100% Wire Protocol Commands</li>
      </ul>
    </li>
  </ul>
</section>


<section class="slide" id="q-and-a">
  <h1>
    Thanks!<br/> Questions?
    <br />
    <span class="by">
      <a href="http://github.com/detro/ghostdriver">http://github.com/detro/ghostdriver</a> -
      <a href="http://github.com/ariya/phantomjs">http://github.com/ariya/phantomjs</a>
    </span>
  </h1>
</section>

<!-- ================================================================= END OF SLIDES -->

<!-- deck.navigation snippet -->
<a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
<a href="#" class="deck-next-link" title="Next">&#8594;</a>

<!-- deck.status snippet -->
<p class="deck-status">
    <span class="deck-status-current"></span>
    /
    <span class="deck-status-total"></span>
</p>

<!-- deck.goto snippet -->
<form action="." method="get" class="goto-form">
    <label for="goto-slide">Go to slide:</label>
    <input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
    <datalist id="goto-datalist"></datalist>
    <input type="submit" value="Go">
</form>

<!-- deck.hash snippet -->
<a href="." title="Permalink to this slide" class="deck-permalink">#</a>


<!-- Grab CDN jQuery, with a protocol relative URL; fall back to local if offline -->
<script src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.min.js"></script>
<script>window.jQuery || document.write('<script src="./jquery-1.7.min.js"><\/script>')</script>

<!-- Deck Core and extensions -->
<script src="./core/deck.core.js"></script>
<script src="./extensions/hash/deck.hash.js"></script>
<script src="./extensions/menu/deck.menu.js"></script>
<script src="./extensions/goto/deck.goto.js"></script>
<script src="./extensions/status/deck.status.js"></script>
<script src="./extensions/navigation/deck.navigation.js"></script>
<!-- Base codemiror code -->
<script src="./extensions/codemirror/codemirror.js"></script>
<script src="./extensions/codemirror/mode/javascript/javascript.js"></script>
<script src="./extensions/codemirror/mode/clike/clike.js"></script>
<script src="./extensions/codemirror/deck.codemirror.js"></script>

<!-- Initialize the deck -->
<script>
$(function() {
    $.deck('.slide');
});
</script>

</body>
</html>
